/// <reference types="koa__router" />
/// <reference types="node" />
/// <reference types="node/http" />
import Koa from 'koa';
import Router from '@koa/router';
import { DBOSExecutor } from "../dbos-executor";
import { GlobalLogger as Logger } from "../telemetry/logs";
export declare const WorkflowUUIDHeader = "dbos-idempotency-key";
export declare const WorkflowRecoveryUrl = "/dbos-workflow-recovery";
export declare const HealthUrl = "/dbos-healthz";
export declare const PerfUrl = "/dbos-perf";
export declare const DeactivateUrl = "/deactivate";
export declare class DBOSHttpServer {
    readonly dbosExec: DBOSExecutor;
    readonly app: Koa;
    readonly adminApp: Koa;
    readonly applicationRouter: Router;
    readonly logger: Logger;
    static nRegisteredEndpoints: number;
    static instance?: DBOSHttpServer;
    /**
     * Create a Koa app.
     * @param dbosExec User pass in an DBOS workflow executor instance.
     * TODO: maybe call dbosExec.init() somewhere in this class?
     */
    constructor(dbosExec: DBOSExecutor);
    static setupAdminApp(dbosExec: DBOSExecutor): Koa;
    /**
     * Register HTTP endpoints and attach to the app. Then start the server at the given port.
     * @param port
     */
    listen(port: number, adminPort: number): Promise<{
        appServer: import("http").Server<typeof import("http").IncomingMessage, typeof import("http").ServerResponse> | undefined;
        adminServer: import("http").Server<typeof import("http").IncomingMessage, typeof import("http").ServerResponse>;
    }>;
    appListen(port: number): Promise<import("http").Server<typeof import("http").IncomingMessage, typeof import("http").ServerResponse> | undefined>;
    static checkPortAvailabilityIPv4Ipv6(port: number, logger: Logger): Promise<void>;
    static checkPortAvailability(port: number, host: string): Promise<void>;
    /**
     * Health check endpoint.
     */
    static registerHealthEndpoint(dbosExec: DBOSExecutor, router: Router): void;
    /**
     * Register workflow recovery endpoint.
     * Receives a list of executor IDs and returns a list of workflowUUIDs.
     */
    static registerRecoveryEndpoint(dbosExec: DBOSExecutor, router: Router): void;
    /**
     * Register performance endpoint.
     * Returns information on VM performance since last call.
     */
    static registerPerfEndpoint(dbosExec: DBOSExecutor, router: Router): void;
    /**
     * Register Deactivate endpoint.
     * Deactivate consumers so that they don't start new workflows.
     *
     */
    static registerDeactivateEndpoint(dbosExec: DBOSExecutor, router: Router): void;
    /**
     * Register decorated functions as HTTP endpoints.
     */
    static registerDecoratedEndpoints(dbosExec: DBOSExecutor, router: Router, app: Koa): void;
}
//# sourceMappingURL=server.d.ts.map