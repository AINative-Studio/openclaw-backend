import { WorkflowContext } from "..";
import { DBOSExecutor } from "../dbos-executor";
import { MethodRegistrationBase } from "../decorators";
export declare enum SchedulerMode {
    ExactlyOncePerInterval = "ExactlyOncePerInterval",
    ExactlyOncePerIntervalWhenActive = "ExactlyOncePerIntervalWhenActive"
}
export declare class SchedulerConfig {
    crontab: string;
    mode?: SchedulerMode;
    queueName?: string;
}
export type ScheduledArgs = [Date, Date];
export interface SchedulerRegistrationBase extends MethodRegistrationBase {
    schedulerConfig?: SchedulerConfig;
}
export declare function Scheduled(schedulerConfig: SchedulerConfig): <This, Ctx extends WorkflowContext, Return>(target: object, propertyKey: string, inDescriptor: TypedPropertyDescriptor<(this: This, ctx: Ctx, ...args: ScheduledArgs) => Promise<Return>>) => TypedPropertyDescriptor<(this: This, ctx: Ctx, args_1: Date, args_2: Date) => Promise<Return>>;
export declare class DBOSScheduler {
    readonly dbosExec: DBOSExecutor;
    constructor(dbosExec: DBOSExecutor);
    schedLoops: DetachableLoop[];
    schedTasks: Promise<void>[];
    initScheduler(): void;
    destroyScheduler(): Promise<void>;
    logRegisteredSchedulerEndpoints(): void;
}
declare class DetachableLoop {
    readonly dbosExec: DBOSExecutor;
    readonly crontab: string;
    readonly schedMode: SchedulerMode;
    readonly scheduledMethod: SchedulerRegistrationBase;
    readonly queueName?: string | undefined;
    private isRunning;
    private interruptResolve?;
    private lastExec;
    private timeMatcher;
    private scheduledMethodName;
    constructor(dbosExec: DBOSExecutor, crontab: string, schedMode: SchedulerMode, scheduledMethod: SchedulerRegistrationBase, queueName?: string | undefined);
    startLoop(): Promise<void>;
    setStopLoopFlag(): void;
}
export {};
//# sourceMappingURL=scheduler.d.ts.map