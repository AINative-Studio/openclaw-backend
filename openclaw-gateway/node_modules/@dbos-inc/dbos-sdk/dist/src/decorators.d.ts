import "reflect-metadata";
import { TransactionConfig, TransactionContext } from "./transaction";
import { WorkflowConfig, WorkflowContext } from "./workflow";
import { DBOSContext, InitContext } from "./context";
import { StepConfig, StepContext } from "./step";
import { StoredProcedureConfig, StoredProcedureContext } from "./procedure";
import { DBOSEventReceiver } from "./eventreceiver";
/**
 * Any column type column can be.
 */
export type DBOSFieldType = "integer" | "double" | "decimal" | "timestamp" | "text" | "varchar" | "boolean" | "uuid" | "json";
export declare class DBOSDataType {
    dataType: DBOSFieldType;
    length: number;
    precision: number;
    scale: number;
    /** Varchar has length */
    static varchar(length: number): DBOSDataType;
    /** Some decimal has precision / scale (as opposed to floating point decimal) */
    static decimal(precision: number, scale: number): DBOSDataType;
    /** Take type from reflect metadata */
    static fromArg(arg: Function): DBOSDataType;
    formatAsString(): string;
}
export declare enum LogMasks {
    NONE = "NONE",
    HASH = "HASH",
    SKIP = "SKIP"
}
export declare enum ArgRequiredOptions {
    REQUIRED = "REQUIRED",
    OPTIONAL = "OPTIONAL",
    DEFAULT = "DEFAULT"
}
export declare class MethodParameter {
    name: string;
    required: ArgRequiredOptions;
    validate: boolean;
    logMask: LogMasks;
    argType: Function;
    dataType: DBOSDataType;
    index: number;
    constructor(idx: number, at: Function);
}
export interface RegistrationDefaults {
    name: string;
    requiredRole: string[] | undefined;
    defaultArgRequired: ArgRequiredOptions;
    eventReceiverInfo: Map<DBOSEventReceiver, unknown>;
}
export interface MethodRegistrationBase {
    name: string;
    className: string;
    args: MethodParameter[];
    defaults?: RegistrationDefaults;
    getRequiredRoles(): string[];
    workflowConfig?: WorkflowConfig;
    txnConfig?: TransactionConfig;
    commConfig?: StepConfig;
    procConfig?: TransactionConfig;
    isInstance: boolean;
    eventReceiverInfo: Map<DBOSEventReceiver, unknown>;
    wrappedFunction: Function | undefined;
    registeredFunction: Function | undefined;
    origFunction: Function;
    readonly passContext: boolean;
    invoke(pthis: unknown, args: unknown[]): unknown;
}
export declare class MethodRegistration<This, Args extends unknown[], Return> implements MethodRegistrationBase {
    readonly passContext: boolean;
    defaults?: RegistrationDefaults | undefined;
    name: string;
    className: string;
    requiredRole: string[] | undefined;
    args: MethodParameter[];
    constructor(origFunc: (this: This, ...args: Args) => Promise<Return>, isInstance: boolean, passContext: boolean);
    needInitialized: boolean;
    isInstance: boolean;
    origFunction: (this: This, ...args: Args) => Promise<Return>;
    registeredFunction: ((this: This, ...args: Args) => Promise<Return>) | undefined;
    wrappedFunction: ((this: This, ...args: Args) => Promise<Return>) | undefined;
    workflowConfig?: WorkflowConfig;
    txnConfig?: TransactionConfig;
    commConfig?: StepConfig;
    procConfig?: TransactionConfig;
    eventReceiverInfo: Map<DBOSEventReceiver, unknown>;
    init: boolean;
    invoke(pthis: This, args: Args): Promise<Return>;
    getRequiredRoles(): string[];
}
export declare abstract class ConfiguredInstance {
    readonly name: string;
    constructor(name: string);
    abstract initialize(ctx: InitContext): Promise<void>;
}
export declare class ClassRegistration<CT extends {
    new (...args: unknown[]): object;
}> implements RegistrationDefaults {
    name: string;
    requiredRole: string[] | undefined;
    defaultArgRequired: ArgRequiredOptions;
    needsInitialized: boolean;
    ormEntities: Function[] | {
        [key: string]: object;
    };
    registeredOperations: Map<string, MethodRegistrationBase>;
    configuredInstances: Map<string, ConfiguredInstance>;
    eventReceiverInfo: Map<DBOSEventReceiver, unknown>;
    ctor: CT;
    constructor(ctor: CT);
}
export declare function getRegisteredMethodClassName(func: unknown): string;
export declare function getRegisteredMethodName(func: unknown): string;
export declare function registerFunctionWrapper(func: unknown, reg: MethodRegistration<unknown, unknown[], unknown>): void;
export declare function getRegisteredOperations(target: object): ReadonlyArray<MethodRegistrationBase>;
export declare function getConfiguredInstance(clsname: string, cfgname: string): ConfiguredInstance | null;
export declare function getOrCreateMethodArgsRegistration(target: object, propertyKey: string | symbol): MethodParameter[];
export declare function registerAndWrapFunction<This, Args extends unknown[], Return>(target: object, propertyKey: string, descriptor: TypedPropertyDescriptor<(this: This, ...args: Args) => Promise<Return>>): {
    descriptor: TypedPropertyDescriptor<(this: This, ...args: Args) => Promise<Return>>;
    registration: MethodRegistration<This, Args, Return>;
};
export declare function registerAndWrapContextFreeFunction<This, Args extends unknown[], Return>(target: object, propertyKey: string, descriptor: TypedPropertyDescriptor<(this: This, ...args: Args) => Promise<Return>>): {
    descriptor: TypedPropertyDescriptor<(this: This, ...args: Args) => Promise<Return>>;
    registration: MethodRegistration<This, Args, Return>;
};
type AnyConstructor = new (...args: unknown[]) => object;
export declare function getAllRegisteredClasses(): AnyConstructor[];
export declare function getOrCreateClassRegistration<CT extends {
    new (...args: unknown[]): object;
}>(ctor: CT): ClassRegistration<AnyConstructor>;
export declare function associateClassWithEventReceiver<CT extends {
    new (...args: unknown[]): object;
}>(rcvr: DBOSEventReceiver, ctor: CT): {};
export declare function associateMethodWithEventReceiver<This, Args extends unknown[], Return>(rcvr: DBOSEventReceiver, target: object, propertyKey: string, inDescriptor: TypedPropertyDescriptor<(this: This, ...args: Args) => Promise<Return>>): {
    descriptor: TypedPropertyDescriptor<(this: This, ...args: Args) => Promise<Return>>;
    registration: MethodRegistration<This, Args, Return>;
    receiverInfo: {};
};
export declare function ArgRequired(target: object, propertyKey: string | symbol, parameterIndex: number): void;
export declare function ArgOptional(target: object, propertyKey: string | symbol, parameterIndex: number): void;
export declare function SkipLogging(target: object, propertyKey: string | symbol, parameterIndex: number): void;
export declare function LogMask(mask: LogMasks): (target: object, propertyKey: string | symbol, parameterIndex: number) => void;
export declare function ArgName(name: string): (target: object, propertyKey: string | symbol, parameterIndex: number) => void;
export declare function ArgDate(): (target: object, propertyKey: string | symbol, parameterIndex: number) => void;
export declare function ArgVarchar(length: number): (target: object, propertyKey: string | symbol, parameterIndex: number) => void;
export declare function DefaultRequiredRole(anyOf: string[]): <T extends new (...args: any[]) => object>(ctor: T) => void;
export declare function DefaultArgRequired<T extends {
    new (...args: unknown[]): object;
}>(ctor: T): void;
export declare function DefaultArgOptional<T extends {
    new (...args: unknown[]): object;
}>(ctor: T): void;
export declare function configureInstance<R extends ConfiguredInstance, T extends unknown[]>(cls: new (name: string, ...args: T) => R, name: string, ...args: T): R;
export declare function RequiredRole(anyOf: string[]): <This, Ctx extends DBOSContext, Args extends unknown[], Return>(target: object, propertyKey: string, inDescriptor: TypedPropertyDescriptor<(this: This, ctx: Ctx, ...args: Args) => Promise<Return>>) => TypedPropertyDescriptor<(this: This, ctx: Ctx, ...args: Args) => Promise<Return>>;
export declare function Workflow(config?: WorkflowConfig): <This, Args extends unknown[], Return>(target: object, propertyKey: string, inDescriptor: TypedPropertyDescriptor<(this: This, ctx: WorkflowContext, ...args: Args) => Promise<Return>>) => TypedPropertyDescriptor<(this: This, ctx: WorkflowContext, ...args: Args) => Promise<Return>>;
export declare function Transaction(config?: TransactionConfig): <This, Args extends unknown[], Return>(target: object, propertyKey: string, inDescriptor: TypedPropertyDescriptor<(this: This, ctx: TransactionContext<any>, ...args: Args) => Promise<Return>>) => TypedPropertyDescriptor<(this: This, ctx: TransactionContext<any>, ...args: Args) => Promise<Return>>;
export declare function StoredProcedure(config?: StoredProcedureConfig): <This, Args extends unknown[], Return>(target: object, propertyKey: string, inDescriptor: TypedPropertyDescriptor<(this: This, ctx: StoredProcedureContext, ...args: Args) => Promise<Return>>) => TypedPropertyDescriptor<(this: This, ctx: StoredProcedureContext, ...args: Args) => Promise<Return>>;
export declare function Step(config?: StepConfig): <This, Args extends unknown[], Return>(target: object, propertyKey: string, inDescriptor: TypedPropertyDescriptor<(this: This, ctx: StepContext, ...args: Args) => Promise<Return>>) => TypedPropertyDescriptor<(this: This, ctx: StepContext, ...args: Args) => Promise<Return>>;
export declare function OrmEntities(entities?: Function[] | {
    [key: string]: object;
}): <T extends new (...args: unknown[]) => object>(ctor: T) => void;
export declare function DBOSInitializer(): <This, Args extends unknown[], Return>(target: object, propertyKey: string, inDescriptor: TypedPropertyDescriptor<(this: This, ctx: InitContext, ...args: Args) => Promise<Return>>) => TypedPropertyDescriptor<(this: This, ctx: InitContext, ...args: Args) => Promise<Return>>;
export declare function DBOSDeploy(): <This, Args extends unknown[], Return>(target: object, propertyKey: string, inDescriptor: TypedPropertyDescriptor<(this: This, ctx: InitContext, ...args: Args) => Promise<Return>>) => TypedPropertyDescriptor<(this: This, ctx: InitContext, ...args: Args) => Promise<Return>>;
export {};
//# sourceMappingURL=decorators.d.ts.map